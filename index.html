<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OpenAssist AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <style>
    body {
      background-color: #000;
      font-family: 'Inter', sans-serif;
      color: #fff;
    }
    ::placeholder {
      color: #888;
    }
    .message {
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      max-width: 80%;
      margin-bottom: 0.5rem;
    }
    .user {
      background-color: #6b21a8;
      align-self: flex-end;
    }
    .bot {
      background-color: #1f2937;
      align-self: flex-start;
    }
    .preview {
      background-color: #111827;
      border: 1px solid #374151;
      border-radius: 1rem;
      padding: 1rem;
      max-width: 80%;
      font-size: 0.875rem;
    }
    .action-btns button {
      font-size: 0.75rem;
      margin-right: 0.5rem;
      background-color: #2d2d2d;
      color: #fff;
      padding: 0.4rem 0.8rem;
      border-radius: 0.5rem;
      border: 1px solid #444;
    }
  </style>
</head>
<body class="flex flex-col h-screen">

  <header class="flex justify-between items-center px-6 py-4 bg-[#111] border-b border-gray-800">
    <h1 class="text-xl font-semibold">OpenAssist Chat</h1>
    <div class="flex gap-4 items-center">
      <button onclick="openSettings()" class="text-gray-400 hover:text-white">
        ‚öôÔ∏è
      </button>
      <button onclick="newChat()" class="text-sm bg-white text-black px-4 py-2 rounded-full font-medium hover:bg-gray-200 transition">New Chat</button>
    </div>
  </header>

  <main id="chatBox" class="flex-grow overflow-y-auto px-4 py-6 flex flex-col space-y-4"></main>

  <footer class="border-t border-gray-800 p-4">
    <div class="flex items-center gap-2">
      <button onclick="addAttachment()" class="text-gray-400">‚ûï</button>
      <textarea id="userInput" rows="1" placeholder="Type a message..." class="flex-grow bg-gray-900 border border-gray-700 text-white rounded px-3 py-2 text-sm resize-none"></textarea>
      <button onclick="startVoice()" class="text-gray-400">üé§</button>
      <button onclick="sendMessage()" class="bg-white text-black px-4 py-2 rounded-full hover:bg-gray-100">Send</button>
    </div>
    <p class="text-xs text-center text-gray-500 mt-2">OpenAssist AI can make mistakes. Check important info.</p>
  </footer>

  <script>
    const chatBox = document.getElementById("chatBox");
    const userInput = document.getElementById("userInput");

    function newChat() {
      chatBox.innerHTML = "";
      userInput.value = "";
    }

    function appendMessage(content, sender, preview) {
      const wrapper = document.createElement("div");
      wrapper.className = `flex flex-col ${sender === 'user' ? 'items-end' : 'items-start'}`;
      const msg = document.createElement("div");
      msg.className = `message ${sender}`;
      msg.textContent = content;
      wrapper.appendChild(msg);
      if (preview) {
        const box = document.createElement("div");
        box.className = "preview";
        box.innerHTML = `
          <div class="text-xs text-gray-400 mb-1">To: <span class="text-white font-medium">${preview.to}</span></div>
          <div class="bg-black px-3 py-2 rounded border border-gray-700 mb-1">${preview.body}</div>
          <div class="text-xs text-green-500">‚úî ${preview.status}</div>
        `;
        wrapper.appendChild(box);

        const actions = document.createElement("div");
        actions.className = "action-btns mt-1";
        actions.innerHTML = `
          <button onclick="sendViaEmail('${preview.body}')">Email</button>
          <button onclick="sendViaWhatsApp('${preview.body}')">WhatsApp</button>
        `;
        wrapper.appendChild(actions);
      }
      chatBox.appendChild(wrapper);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function sendViaWhatsApp(text) {
      window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }

    function sendViaEmail(text) {
      const subject = encodeURIComponent("Message from OpenAssist AI");
      const body = encodeURIComponent(text);
      window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
    }

    function sendMessage() {
      const input = userInput.value.trim();
      if (!input) return;
      const to = extractRecipient(input);
      appendMessage(input, "user");
      userInput.value = "";

      setTimeout(() => {
        appendMessage("Here's your generated message:", "bot", {
          to: to || "Email, WhatsApp, or Text",
          body: "This is a preview of the message that will be sent. You can review or edit before sending.",
          status: "Message generated and ready to send."
        });
      }, 500);
    }

    function extractRecipient(text) {
      const match = text.match(/(?:email|message|text) (?:to )?(?:my )?(\w+)/i);
      return match ? match[1] : "";
    }

    userInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    function openSettings() {
      alert("Settings not available in this static version.");
    }

    function startVoice() {
      alert("Voice input coming soon.");
    }

    function addAttachment() {
      alert("Add attachments coming soon.");
    }
  </script>
</body>
</html>
